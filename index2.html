<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>BUETAirlines | Dashboard</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.7 -->
  <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
  <!-- Morris chart -->
  <link rel="stylesheet" href="bower_components/morris.js/morris.css">
  <!-- jvectormap -->
  <link rel="stylesheet" href="bower_components/jvectormap/jquery-jvectormap.css">
  <!-- Date Picker -->
  <link rel="stylesheet" href="bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
  <!-- Daterange picker -->
  <link rel="stylesheet" href="bower_components/bootstrap-daterangepicker/daterangepicker.css">
  <!-- bootstrap wysihtml5 - text editor -->
  <link rel="stylesheet" href="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">

  <link rel="stylesheet" href="bower_components/fullcalendar/dist/fullcalendar.min.css">
  <link rel="stylesheet" href="bower_components/fullcalendar/dist/fullcalendar.print.min.css" media="print">



  <!-- Google Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

</head>
<body class="hold-transition skin-purple sidebar-mini" onload="empget();">
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
    <a href="index2.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini"><b>A</b>LT</span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg"><b>Control </b>Panel</span>
    </a>
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        
      </div>
    </nav>
  </header>

  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- Sidebar user panel -->
      <div class="user-panel">
        <div class="pull-left image">
          <img src="dist/img/user1-128x128.jpg" class="img-circle" alt="User Image">
        </div>
        <div class="pull-left info">
          <p>Awsaf Alam</p>
          <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
        </div>
      </div>
      <!-- search form -->
      <form action="#" method="get" class="sidebar-form">
        <div class="input-group">
          <input type="text" name="q" class="form-control" placeholder="Search...">
          <span class="input-group-btn">
                <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
                </button>
              </span>
        </div>
      </form>
      <!-- /.search form -->
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu" data-widget="tree">
        <li class="header">MAIN NAVIGATION</li>
        <li>
          <a href="index2.html">
            <i class="fa fa-dashboard"></i> <span>Dashboard</span>
          </a>
          
        </li>
        <li class="header">Profile</li>
        <li><a href="index.html"><i class="fa fa-circle-o text-red"></i> <span>Log out</span></a></li>
        <!-- <li><a href="#"><i class="fa fa-circle-o text-yellow"></i> <span>Warning</span></a></li>
        <li><a href="#"><i class="fa fa-circle-o text-aqua"></i> <span>Information</span></a></li> -->
      </ul>
    </section>
    <!-- /.sidebar -->
  </aside>

<!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        Dashboard
        <small>Control panel</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Dashboard</li>
      </ol>
    </section>

      <!-- Main content -->
    <section class="content">
      <div class="row">
        
        <div class="col-xs-12">
          <div class="box box-primary">
            <div class="box-body no-padding">
              <!-- THE CALENDAR -->
              <div id="calendar"></div>
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /. box -->
        </div>

        
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
    </section>
  


    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
    <div class="pull-right hidden-xs">
      <b>Version</b> 1.0.0
    </div>
    <strong>Copyright &copy; 2017 <a href="https://awsaf114.github.io">Awsaf Alam</a>.</strong> All rights
    reserved.
  </footer>

  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- Modal -->
<div class="modal fade" id="UpdateEventModal" role="dialog">
  <div class="modal-dialog" >
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Update FLight Status</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h2>Schedule</h2>

        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown">
            Status
          </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
           <li><a class="dropdown-item" href="#">ON TIME</a></li> 
           <li><a class="dropdown-item" href="#">DELAYED</a></li> 
          </ul>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


<!-- jQuery 3 -->
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="bower_components/jquery-ui/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button);
</script>
<!-- Bootstrap 3.3.7 -->
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Morris.js charts -->
<script src="bower_components/raphael/raphael.min.js"></script>
<script src="bower_components/morris.js/morris.min.js"></script>
<!-- Sparkline -->
<script src="bower_components/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
<!-- jvectormap -->
<script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
<script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<!-- jQuery Knob Chart -->
<script src="bower_components/jquery-knob/dist/jquery.knob.min.js"></script>

<!-- DataTables -->
<script src="../../bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../../bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>


<!-- daterangepicker -->
<script src="bower_components/moment/min/moment.min.js"></script>
<script src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- datepicker -->
<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<!-- Bootstrap WYSIHTML5 -->
<script src="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<!-- Slimscroll -->
<script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="bower_components/fastclick/lib/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.min.js"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<!-- <script src="dist/js/pages/dashboard.js"></script> -->
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>

<!-- fullCalendar -->
<script src="bower_components/moment/moment.js"></script>
<script src="bower_components/fullcalendar/dist/fullcalendar.min.js"></script>

<script type="text/javascript">
var waitingDialog = waitingDialog || (function ($) {
    'use strict';

  // Creating modal dialog's DOM
  var $dialog = $(
    '<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:15%; overflow-y:visible;">' +
    '<div class="modal-dialog modal-m">' +
    '<div class="modal-content">' +
      '<div class="modal-header"><h3 style="margin:0;"></h3></div>' +
      '<div class="modal-body">' +
        '<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>' +
      '</div>' +
    '</div></div></div>');

  return {
    /**
     * Opens our dialog
     * @param message Custom message
     * @param options Custom options:
     *          options.dialogSize - bootstrap postfix for dialog size, e.g. "sm", "m";
     *          options.progressType - bootstrap postfix for progress bar type, e.g. "success", "warning".
     */
    show: function (message, options) {
      // Assigning defaults
      if (typeof options === 'undefined') {
        options = {};
      }
      if (typeof message === 'undefined') {
        message = 'Loading';
      }
      var settings = $.extend({
        dialogSize: 'm',
        progressType: '',
        onHide: null // This callback runs after the dialog was hidden
      }, options);

      // Configuring dialog
      $dialog.find('.modal-dialog').attr('class', 'modal-dialog').addClass('modal-' + settings.dialogSize);
      $dialog.find('.progress-bar').attr('class', 'progress-bar');
      if (settings.progressType) {
        $dialog.find('.progress-bar').addClass('progress-bar-' + settings.progressType);
      }
      $dialog.find('h3').text(message);
      // Adding callbacks
      if (typeof settings.onHide === 'function') {
        $dialog.off('hidden.bs.modal').on('hidden.bs.modal', function (e) {
          settings.onHide.call($dialog);
        });
      }
      // Opening dialog
      $dialog.modal();
    },
    /**
     * Closes dialog
     */
    hide: function () {
      $dialog.modal('hide');
    }
  };
})(jQuery);

var EMPLOYEE_ID;
function empget() {
  // body...
  var url = document.location.href;
    var data = url.split('?')[1].split('=')[1];
    EMPLOYEE_ID = data;
    // var FLight_dep = data[0].split('=')[1];
}

$(document).ready(function () {
  // body...

  
    /* initialize the external events
     -----------------------------------------------------------------*/
    function init_events(ele) {
      ele.each(function () {

        // create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
        // it doesn't need to have a start or end
        var eventObject = {
          title: $.trim($(this).text()), // use the element's text as the event title
          duration: '03:00:00' 
        }

        // store the Event Object in the DOM element so we can get to it later
        $(this).data('eventObject', eventObject)

        // make the event draggable using jQuery UI
        $(this).draggable({
          zIndex        : 1070,
          revert        : true, // will cause the event to go back to its
          revertDuration: 0  //  original position after the drag
        })

      })
    }

    // init_events($('#external-events div.external-event'))

    //Date for the calendar events (dummy data)
    var date = new Date()
    var d    = date.getDate(), // 1- 31
        m    = date.getMonth(), //0 11
        y    = date.getFullYear() //accurate

    // console.log(date.toJSON());
    $('#calendar').fullCalendar({
      header    : {
        left  : 'prev,next today',
        center: 'title',
        right : 'month,agendaWeek,agendaDay'
      },
      buttonText: {
        today: 'today',
        month: 'month',
        week : 'week',
        day  : 'day'
      },
      // defaultView: 'agendaWeek',
      //Random default events
      events    : function (start , end , timezone , callback) {
        // body...
        var getFromDb="v1/index.php?table=CrewSchedule&Flight="+EMPLOYEE_ID;
         var Obj;
         xmlhttp = new XMLHttpRequest();

       
        var EmploSch;
        var events = [];
        xmlhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            console.log(this.responseText);
            EmploSch = JSON.parse(this.responseText);
            SCHEDULE_DATA = EmploSch;
            // MakeEvents(Emplotable);
            console.log(EmploSch);
            // console.log(y+" " + m +" "+ d);
            for(var i=0 ; i<(EmploSch.length); i++){
              // console.log("in loop");

              var Title = EmploSch[i].Source + " - " + EmploSch[i].Destination
                          +" ("+ EmploSch[i].Status+")";
              
              var Arrival = EmploSch[i].Arrival.split(" ");
              var Arrdate = Arrival[0].split("-");
              var ArrTime = Arrival[1].split(":");
            
              var Depparture = EmploSch[i].Departure.split(" ");
              var Depdate = Depparture[0].split("-");
              var DepTime = Depparture[1].split(":");
              var Color;
              if (EmploSch[i].Status == "DELAYED") {
                Color = '#c62828';
              }else{
                Color = '#00a65a';
              }

              events.push({
                title          : Title,
                id             : EmploSch[i].Flight,
                start          : new Date(Depdate[0], Depdate[1]-1, Depdate[2], DepTime[0],DepTime[1] , DepTime[2]),
                end            : new Date(Arrdate[0], Arrdate[1]-1, Arrdate[2], ArrTime[0],ArrTime[1] , ArrTime[2]),
                allDay         : false,
                backgroundColor: Color, //Success (green)
                borderColor    : Color //Success (green)
              });
            
              //   var body = document.getElementById('bodymain');
              //   var modal = document.createElement('div');
              //   modal.classList.add('modal');
              //   modal.classList.add('fade');
              //   modal.id = EmploSch[i].Flight;
              //   body.append(modal);

              //   var mdialog = document.createElement('div');
              //   mdialog.classList.add('modal-dialog');
              //   modal.append(mdialog);

              //   var content = document.createElement('div');
              //   content.classList.add('modal-content');
              //   mdialog.append(content);

              //   var mheader = document.createElement('div');
              //   mheader.classList.add('modal-header');
              //   content.append(mheader);

              //   var h3 = document.createElement('h3');
              //   h3.classList.add('modal-title');
              //   h3.textContent = "Flight Details";
              //   mheader.append(h3);

              //   // var str = document.createElement('strong');
              //   // str = Title;
              //   // mheader.append(str);

              //   var mbody = document.createElement('div');
              //   mbody.classList.add('modal-body');
              //   // mbody.style.cssText = 'display: flex;';
              //   content.append(mbody);

              //   var h3 = document.createElement('h3');
              //   h3.textContent = "Flight "+EmploSch[i].Flight+" -> "+Title;
              //   mbody.append(h3);

              //   var actions = document.createElement('div');
              //   actions.style.cssText = 'display: flex';
              //   mbody.append(actions);

              //   var drop = document.createElement('div');
              //   drop.classList.add('dropdown');
              //   drop.style.cssText = 'margin-right: 10px;';
              //   actions.append(drop);

              //   var btn = document.createElement('button');
              //   btn.classList.add('btn');
              //   btn.classList.add('btntextchange');
              //   btn.classList.add('btn-primary');
              //   btn.classList.add('dropdown-toggle');
              //   btn.id = "dropdownMenuButton"+modal.id;
              //   btn.type = "button";
              //   btn.setAttribute("data-toggle", "dropdown");
              //   btn.textContent = "Flight Status";
              //   drop.append(btn);

              //   var ul = document.createElement('ul');
              //   ul.classList.add('dropdown-menu');
              //   drop.append(ul);

              //   var li = document.createElement('li');
              //   ul.append(li);
                
              //   var listitem = document.createElement('a');
              //   listitem.classList.add('dropdown-item');
              //   // li.classList.add('btn-success');
              //   listitem.textContent = "ON TIME";
              //   listitem.style.cursor = "pointer";
              //   li.append(listitem);

              //   var li1 = document.createElement('li');
              //   ul.append(li1);
                
              //   var listitem1 = document.createElement('a');
              //   listitem1.classList.add('dropdown-item');
              //   // listitem.classList.add('btn-danger');
              //   listitem1.textContent = "DELAYED";
              //   listitem1.style.cursor = "pointer";
              //   li1.append(listitem1);

              //   var del = document.createElement('button');
              //   del.classList.add('btn');
              //   del.classList.add('btn-danger');
              //   del.id = "del"+modal.id;
              //   del.textContent = "Delete Schedule";
              //   actions.append(del);




              //   var mfooter = document.createElement('div');
              //   mfooter.classList.add('modal-footer');
              //   content.append(mfooter);

              //   var save = document.createElement('button');
              //   save.type = "button";
              //   save.id = "save"+modal.id;
              //   save.textContent = "Save Changes";
              //   save.classList.add('btn');
              //   save.classList.add('btn-primary');
              //   mfooter.append(save);

              //   var cancel = document.createElement('button');
              //   cancel.type = "button";
              //   cancel.textContent = "Close";
              //   cancel.classList.add('btn');
              //   cancel.classList.add('btn-primary');
              //   cancel.setAttribute("data-dismiss","modal");
              //   mfooter.append(cancel);


              //   $(".dropdown-menu li a").click(function(){
    
              //     $(".btntextchange:first-child").text($(this).text());
              //      $(".btntextchange:first-child").val($(this).text());
              //   });

              // handleclick(modal.id);

            }
            waitingDialog.hide();
                // console.log(callback);
            callback(events); 
          }
            };
         xmlhttp.open("GET", getFromDb, true);

        xmlhttp.send();
        waitingDialog.show("Loading Schedule Data")
      },
      selectable: true,
      selectHelper: true,
      // eventLimit: true,
      editable  : true,
      droppable : true, // this allows things to be dropped onto the calendar !!!
      eventClick: function (calevent , jsEvent , view) {
        // body...
        var ID = calevent.id;
        console.log(calevent.title+" "+calevent.id);
        console.log('View: ' + view.name);

        // var start = $.fullCalendar.moment(calevent.end).format('h:mm');
        // var end = $.fullcalendar.moment(calevent.start).format('dddd , MMMM Do YYYY . h:mm')



        // change the border color just for fun
        $(this).css('background-color', 'red');
        $('#'+ID).modal('toggle');

      },
      eventDrop: function(event, delta, revertFunc) {

        //alert(event.title + " was dropped on " + event.start.format());

        if (!confirm("Are you sure about this change?")) {
            revertFunc();
        }
        else{
          
        }

    },
    drop      : function (date, allDay) { // this function is called when something is dropped

      // retrieve the dropped element's stored Event Object
      var originalEventObject = $(this).data('eventObject')

      // we need to copy it, so that multiple events don't have a reference to the same object
      var copiedEventObject = $.extend({}, originalEventObject)
      console.log(copiedEventObject);
      console.log(date);
      console.log(allDay);

      var Dur = copiedEventObject.duration.split(':');
      // assign it the date that was reported
      copiedEventObject.start           = new Date(date)
      copiedEventObject.allDay          = false
      // Default duration 2 hrs when end not specifies
      // copiedEventObject.end = new Date(  Dur[0]+1 , Dur[1] ); // does not work
      copiedEventObject.backgroundColor = $(this).css('background-color')
      copiedEventObject.borderColor     = $(this).css('border-color')

      console.log(copiedEventObject.end);
      console.log(new Date(copiedEventObject.start).getTime()+(Dur[0]));

      // render the event on the calendar
      // the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
      $('#calendar').fullCalendar('renderEvent', copiedEventObject, true)

      // is the "remove after drop" checkbox checked?
      // if ($('#drop-remove').is(':checked')) {
      //   // if so, remove the element from the "Draggable Events" list
      //   $(this).remove()
      // }

    }
    })


    /* ADDING EVENTS */
    function addOthers() {
      // body...
      EmploSch = SCHEDULE_DATA;
      for(var i=(EmploSch.length)/5 ; i<(EmploSch.length) ; i++){
              // console.log("in loop");

              var Title = EmploSch[i].Source + " - " + EmploSch[i].Destination
                          +" ("+ EmploSch[i].Status+")";
              
              var Arrival = EmploSch[i].Arrival.split(" ");
              var Arrdate = Arrival[0].split("-");
              var ArrTime = Arrival[1].split(":");
            
              var Depparture = EmploSch[i].Departure.split(" ");
              var Depdate = Depparture[0].split("-");
              var DepTime = Depparture[1].split(":");
              var Color;
              if (EmploSch[i].Status == "DELAYED") {
                Color = '#c62828';
              }else{
                Color = '#00a65a';
              }

              events.push({
                title          : Title,
                id             : EmploSch[i].Flight,
                start          : new Date(Depdate[0], Depdate[1]-1, Depdate[2], DepTime[0],DepTime[1] , DepTime[2]),
                end            : new Date(Arrdate[0], Arrdate[1]-1, Arrdate[2], ArrTime[0],ArrTime[1] , ArrTime[2]),
                allDay         : false,
                backgroundColor: Color, //Success (green)
                borderColor    : Color //Success (green)
              });
            
                var body = document.getElementById('bodymain');
                var modal = document.createElement('div');
                modal.classList.add('modal');
                modal.classList.add('fade');
                modal.id = EmploSch[i].Flight;
                body.append(modal);

                var mdialog = document.createElement('div');
                mdialog.classList.add('modal-dialog');
                modal.append(mdialog);

                var content = document.createElement('div');
                content.classList.add('modal-content');
                mdialog.append(content);

                var mheader = document.createElement('div');
                mheader.classList.add('modal-header');
                content.append(mheader);

                var h3 = document.createElement('h3');
                h3.classList.add('modal-title');
                h3.textContent = "Flight Details";
                mheader.append(h3);

                // var str = document.createElement('strong');
                // str = Title;
                // mheader.append(str);

                var mbody = document.createElement('div');
                mbody.classList.add('modal-body');
                // mbody.style.cssText = 'display: flex;';
                content.append(mbody);

                var h3 = document.createElement('h3');
                h3.textContent = "Flight "+EmploSch[i].Flight+" -> "+Title;
                mbody.append(h3);

                var actions = document.createElement('div');
                actions.style.cssText = 'display: flex';
                mbody.append(actions);

                var drop = document.createElement('div');
                drop.classList.add('dropdown');
                drop.style.cssText = 'margin-right: 10px;';
                actions.append(drop);

                var btn = document.createElement('button');
                btn.classList.add('btn');
                btn.classList.add('btntextchange');
                btn.classList.add('btn-primary');
                btn.classList.add('dropdown-toggle');
                btn.id = "dropdownMenuButton"+modal.id;
                btn.type = "button";
                btn.setAttribute("data-toggle", "dropdown");
                btn.textContent = "Flight Status";
                drop.append(btn);

                var ul = document.createElement('ul');
                ul.classList.add('dropdown-menu');
                drop.append(ul);

                var li = document.createElement('li');
                ul.append(li);
                
                var listitem = document.createElement('a');
                listitem.classList.add('dropdown-item');
                // li.classList.add('btn-success');
                listitem.textContent = "ON TIME";
                listitem.style.cursor = "pointer";
                li.append(listitem);

                var li1 = document.createElement('li');
                ul.append(li1);
                
                var listitem1 = document.createElement('a');
                listitem1.classList.add('dropdown-item');
                // listitem.classList.add('btn-danger');
                listitem1.textContent = "DELAYED";
                listitem1.style.cursor = "pointer";
                li1.append(listitem1);

                var del = document.createElement('button');
                del.classList.add('btn');
                del.classList.add('btn-danger');
                del.id = "del"+modal.id;
                del.textContent = "Delete Schedule";
                actions.append(del);




                var mfooter = document.createElement('div');
                mfooter.classList.add('modal-footer');
                content.append(mfooter);

                var save = document.createElement('button');
                save.type = "button";
                save.id = "save"+modal.id;
                save.textContent = "Save Changes";
                save.classList.add('btn');
                save.classList.add('btn-primary');
                mfooter.append(save);

                var cancel = document.createElement('button');
                cancel.type = "button";
                cancel.textContent = "Close";
                cancel.classList.add('btn');
                cancel.classList.add('btn-primary');
                cancel.setAttribute("data-dismiss","modal");
                mfooter.append(cancel);


                $(".dropdown-menu li a").click(function(){
    
                  $(".btntextchange:first-child").text($(this).text());
                   $(".btntextchange:first-child").val($(this).text());
                });

              handleclick(modal.id);

            }
    }

    var currColor = '#3c8dbc' //Red by default
    //Color chooser button
    var colorChooser = $('#color-chooser-btn')
    $('#color-chooser > li > a').click(function (e) {
      e.preventDefault()
      //Save color
      currColor = $(this).css('color')
      //Add color effect to button
      $('#add-new-event').css({ 'background-color': currColor, 'border-color': currColor })
    })
    $('#add-new-event').click(function (e) {
      e.preventDefault()

      //Get value and make sure it is not null
      var val = $('#From').val(),
       To = $('#To').val(),
       Departure = $('#depart').val(),
       Plane = $('#Plane').val(),
       Arrival = $('#arrive').val();

      var str = Departure.split(" ");
      var datechange = str[0].split("/");
      var dep = datechange[2]+"-"+datechange[0]+"-"+datechange[1];


      // var formating = dep.split(" ");
      if(str[2] == "PM"){
          var hr = str[1].split(":");
          var i = parseInt(hr[0]);
          i = i +12;
          var newformat = i+":"+hr[1]+":00"
          dep = dep+" "+newformat;
      }
      else{
          var newformat = str[1]+":00"
          dep = dep+" "+newformat;
      }


      if (val.length == 0) {
        return
      }
      console.log(dep);
      //Create events
      var event = $('<div />')

      event.css({
        'background-color': currColor,
        'border-color'    : currColor,
        'color'           : '#fff'
      }).addClass('external-event')
      event.html(val+" - "+To)
      event.data('duration' , '03:00')
      $('#external-events').prepend(event)

      //Add draggable funtionality
      init_events(event)

      //Remove event from text input
      $('#From').val('')
      $('#To').val('')
      $('#depart').val('')
      $('#Plane').val('')
      $('#arrive').val('')

  // body...
  console.log("Validation start");
  
  var data=new FormData();
  data.append('Source',val);
  data.append('Destination',To);
  data.append('Aircraft_ID',Plane);
  data.append('Departure',dep);
  data.append('Arrival',Arrival);
  data.append('Plane' , Plane);
  

  //Insert New Passenger
  var PosttoDb="../../v1/Schedule_insert.php";
    var Obj;
    xmlhttp = new XMLHttpRequest();
   
  //   var flightresponse;
    xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      console.log("Data sent");
      console.log(this.responseText+"   Posted   ......");
    }
  };
   xmlhttp.open("POST", PosttoDb , true);

   xmlhttp.send(data);
      location.reload();
  


    })

});
</script>

</body>
</html>
